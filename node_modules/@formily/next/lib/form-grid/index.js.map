{"version":3,"file":"index.js","sourceRoot":"","sources":["../../src/form-grid/index.tsx"],"names":[],"mappings":"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","sourcesContent":["import React, { useLayoutEffect, useRef, useMemo, useContext } from 'react'\nimport { markRaw } from '@formily/reactive'\nimport { observer } from '@formily/react'\nimport { Grid, IGridOptions } from '@formily/grid'\nimport { usePrefixCls, pickDataProps } from '../__builtins__'\nimport { useFormLayout } from '../form-layout'\nimport cls from 'classnames'\n\nconst FormGridContext = React.createContext<Grid<HTMLElement>>(null)\n\nexport interface IFormGridProps extends IGridOptions {\n  grid?: Grid<HTMLElement>\n  prefix?: string\n  className?: string\n  style?: React.CSSProperties\n}\n\nexport interface IGridColumnProps {\n  gridSpan?: number\n  style?: React.CSSProperties\n  className?: string\n}\n\ntype ComposedFormGrid = React.FC<React.PropsWithChildren<IFormGridProps>> & {\n  GridColumn: React.FC<React.PropsWithChildren<IGridColumnProps>>\n  useFormGrid: () => Grid<HTMLElement>\n  createFormGrid: (props: IFormGridProps) => Grid<HTMLElement>\n  /**\n   * @deprecated\n   */\n  useGridSpan: (gridSpan: number) => number\n  /**\n   * @deprecated\n   */\n  useGridColumn: (gridSpan: number) => number\n}\n\nexport const createFormGrid = (props: IFormGridProps) => {\n  return markRaw(new Grid(props))\n}\n\nexport const useFormGrid = () => useContext(FormGridContext)\n\n/**\n * @deprecated\n */\nexport const useGridSpan = (gridSpan = 1) => {\n  return gridSpan\n}\n/**\n * @deprecated\n */\nexport const useGridColumn = (gridSpan = 1) => {\n  return gridSpan\n}\n\nexport const FormGrid: ComposedFormGrid = observer(\n  ({\n    children,\n    className,\n    style,\n    ...props\n  }: React.PropsWithChildren<IFormGridProps>) => {\n    const layout = useFormLayout()\n    const options = {\n      columnGap: layout?.gridColumnGap ?? 8,\n      rowGap: layout?.gridRowGap ?? 4,\n      ...props,\n    }\n    const grid = useMemo(\n      () => markRaw(options?.grid ? options.grid : new Grid(options)),\n      [Grid.id(options)]\n    )\n    const ref = useRef<HTMLDivElement>()\n    const prefixCls = usePrefixCls('formily-grid', props)\n    const dataProps = pickDataProps(props)\n    useLayoutEffect(() => {\n      return grid.connect(ref.current)\n    }, [grid])\n    return (\n      <FormGridContext.Provider value={grid}>\n        <div\n          {...dataProps}\n          className={cls(`${prefixCls}-layout`, className)}\n          style={{\n            ...style,\n            gridTemplateColumns: grid.templateColumns,\n            gap: grid.gap,\n          }}\n          ref={ref}\n        >\n          {children}\n        </div>\n      </FormGridContext.Provider>\n    )\n  },\n  {\n    forwardRef: true,\n  }\n) as any\n\nexport const GridColumn: React.FC<React.PropsWithChildren<IGridColumnProps>> =\n  observer(({ gridSpan, children, ...props }) => {\n    return (\n      <div {...props} data-grid-span={gridSpan}>\n        {children}\n      </div>\n    )\n  })\n\nGridColumn.defaultProps = {\n  gridSpan: 1,\n}\n\nFormGrid.createFormGrid = createFormGrid\nFormGrid.useFormGrid = useFormGrid\nFormGrid.useGridSpan = useGridSpan\nFormGrid.useGridColumn = useGridColumn\nFormGrid.GridColumn = GridColumn\n\nexport default FormGrid\n"]}