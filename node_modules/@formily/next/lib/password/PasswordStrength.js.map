{"version":3,"file":"PasswordStrength.js","sourceRoot":"","sources":["../../src/password/PasswordStrength.tsx"],"names":[],"mappings":"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","sourcesContent":["import React, { Fragment } from 'react'\nimport { ReactFC } from '@formily/react'\nimport { isFn } from '@formily/shared'\n\ntype ReactRenderPropsChildren<T = any> =\n  | React.ReactNode\n  | ((props: T) => React.ReactElement)\n\ninterface IPasswordStrengthProps {\n  value?: React.ReactText\n  children?: ReactRenderPropsChildren<number>\n}\n\nconst isNum = function (c) {\n  return c >= 48 && c <= 57\n}\nconst isLower = function (c) {\n  return c >= 97 && c <= 122\n}\nconst isUpper = function (c) {\n  return c >= 65 && c <= 90\n}\nconst isSymbol = function (c) {\n  return !(isLower(c) || isUpper(c) || isNum(c))\n}\nconst isLetter = function (c) {\n  return isLower(c) || isUpper(c)\n}\n\nconst getStrength = (val) => {\n  if (!val) return 0\n  let num = 0\n  let lower = 0\n  let upper = 0\n  let symbol = 0\n  let MNS = 0\n  let rep = 0\n  let repC = 0\n  let consecutive = 0\n  let sequential = 0\n  const len = () => num + lower + upper + symbol\n  const callme = () => {\n    let re = num > 0 ? 1 : 0\n    re += lower > 0 ? 1 : 0\n    re += upper > 0 ? 1 : 0\n    re += symbol > 0 ? 1 : 0\n    if (re > 2 && len() >= 8) {\n      return re + 1\n    } else {\n      return 0\n    }\n  }\n  for (let i = 0; i < val.length; i++) {\n    const c = val.charCodeAt(i)\n    if (isNum(c)) {\n      num++\n      if (i !== 0 && i !== val.length - 1) {\n        MNS++\n      }\n      if (i > 0 && isNum(val.charCodeAt(i - 1))) {\n        consecutive++\n      }\n    } else if (isLower(c)) {\n      lower++\n      if (i > 0 && isLower(val.charCodeAt(i - 1))) {\n        consecutive++\n      }\n    } else if (isUpper(c)) {\n      upper++\n      if (i > 0 && isUpper(val.charCodeAt(i - 1))) {\n        consecutive++\n      }\n    } else {\n      symbol++\n      if (i !== 0 && i !== val.length - 1) {\n        MNS++\n      }\n    }\n    let exists = false\n    for (let j = 0; j < val.length; j++) {\n      if (val[i] === val[j] && i !== j) {\n        exists = true\n        repC += Math.abs(val.length / (j - i))\n      }\n    }\n    if (exists) {\n      rep++\n      const unique = val.length - rep\n      repC = unique ? Math.ceil(repC / unique) : Math.ceil(repC)\n    }\n    if (i > 1) {\n      const last1 = val.charCodeAt(i - 1)\n      const last2 = val.charCodeAt(i - 2)\n      if (isLetter(c)) {\n        if (isLetter(last1) && isLetter(last2)) {\n          const v = val.toLowerCase()\n          const vi = v.charCodeAt(i)\n          const vi1 = v.charCodeAt(i - 1)\n          const vi2 = v.charCodeAt(i - 2)\n          if (vi - vi1 === vi1 - vi2 && Math.abs(vi - vi1) === 1) {\n            sequential++\n          }\n        }\n      } else if (isNum(c)) {\n        if (isNum(last1) && isNum(last2)) {\n          if (c - last1 === last1 - last2 && Math.abs(c - last1) === 1) {\n            sequential++\n          }\n        }\n      } else {\n        if (isSymbol(last1) && isSymbol(last2)) {\n          if (c - last1 === last1 - last2 && Math.abs(c - last1) === 1) {\n            sequential++\n          }\n        }\n      }\n    }\n  }\n  let sum = 0\n  const length = len()\n  sum += 4 * length\n  if (lower > 0) {\n    sum += 2 * (length - lower)\n  }\n  if (upper > 0) {\n    sum += 2 * (length - upper)\n  }\n  if (num !== length) {\n    sum += 4 * num\n  }\n  sum += 6 * symbol\n  sum += 2 * MNS\n  sum += 2 * callme()\n  if (length === lower + upper) {\n    sum -= length\n  }\n  if (length === num) {\n    sum -= num\n  }\n  sum -= repC\n  sum -= 2 * consecutive\n  sum -= 3 * sequential\n  sum = sum < 0 ? 0 : sum\n  sum = sum > 100 ? 100 : sum\n\n  if (sum >= 80) {\n    return 100\n  } else if (sum >= 60) {\n    return 80\n  } else if (sum >= 40) {\n    return 60\n  } else if (sum >= 20) {\n    return 40\n  } else {\n    return 20\n  }\n}\n\nexport const PasswordStrength: ReactFC<IPasswordStrengthProps> = (props) => {\n  if (isFn(props.children)) {\n    return props.children(getStrength(String(props.value)))\n  } else {\n    return <Fragment>{props.children}</Fragment>\n  }\n}\n"]}