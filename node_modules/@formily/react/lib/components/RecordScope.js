"use strict";
var __importDefault = (this && this.__importDefault) || function (mod) {
    return (mod && mod.__esModule) ? mod : { "default": mod };
};
Object.defineProperty(exports, "__esModule", { value: true });
exports.RecordScope = void 0;
var react_1 = __importDefault(require("react"));
var shared_1 = require("@formily/shared");
var ExpressionScope_1 = require("./ExpressionScope");
var hooks_1 = require("../hooks");
var RecordScope = function (props) {
    var scope = (0, hooks_1.useExpressionScope)();
    return (react_1.default.createElement(ExpressionScope_1.ExpressionScope, { value: {
            get $lookup() {
                return scope === null || scope === void 0 ? void 0 : scope.$record;
            },
            get $record() {
                var _a;
                var record = (_a = props.getRecord) === null || _a === void 0 ? void 0 : _a.call(props);
                if (typeof record === 'object') {
                    return (0, shared_1.lazyMerge)(record, {
                        get $lookup() {
                            return scope === null || scope === void 0 ? void 0 : scope.$record;
                        },
                        get $index() {
                            var _a;
                            return (_a = props.getIndex) === null || _a === void 0 ? void 0 : _a.call(props);
                        },
                    });
                }
                return record;
            },
            get $index() {
                var _a;
                return (_a = props.getIndex) === null || _a === void 0 ? void 0 : _a.call(props);
            },
        } }, props.children));
};
exports.RecordScope = RecordScope;
//# sourceMappingURL=RecordScope.js.map