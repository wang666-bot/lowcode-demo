!function(e,r){"object"==typeof exports&&"undefined"!=typeof module?r(exports):"function"==typeof define&&define.amd?define(["exports"],r):(e=e||self,r(e.jsonuri={}))}(this,function(e){"use strict";var r=function(){},n=Array.isArray,t=function(e){return"string"==typeof e},i=function(e){return Number.isInteger(e)},o=function(e){return i(e)&&e>=0},u=/\//,a=function(e){return u.test(e)},f=function(e){var r=typeof e;return null!=e&&("object"===r||"function"===r)},l=function(e){return e+""},p=function(e){console.error(e)},s=function(e,r,t){if(!n(e))return void(e[r]=t);if("length"===r){if(!o(t))throw new Error("value: "+t+" is not a natural number");return t>e.length&&(e.length=t),void e.splice(t)}var i=+r;if(!o(i))return void p("key: "+r+" is not a natural number");e.length=Math.max(e.length,i),e.splice(i,1,t)},c=function(e,r){if(n(e)){var t=+r;if(!o(t))return;e.splice(t,1)}else delete e[r]},v=function(e,r,n,t){if(void 0===t&&(t="after"),r<0||r>e.length)throw new Error("the Index Out of Bounds");switch(t){case"before":r-=1;break;case"append":p("TODO")}e.splice(r,0,n)},h=function(e){var r,n,t=null!==(r=e.path)&&void 0!==r?r:"";for(null==e.keys?n=e.path.split("/"):t||(n=e.keys),n=n.filter(Boolean);~n.indexOf("");){i=n.indexOf("");n.splice(i,1)}for(;~n.indexOf(".");){var i=n.indexOf(".");n.splice(i,1)}for(;~n.indexOf("..");)n[i=n.indexOf("..")]=n[i-1]="",delete n[i],delete n[i-1],n.splice(i,1),n.splice(i-1,1);return{keys:n,path:n.join("/")}},d=function(e,r){if(null==e)return e;if(""===(r=l(r)))return e;if(!a(r))return e[r];var n,t=h({path:r}).keys;if(0===t.length)return e;for(var i=t.length,o=0;o<i&&null!=(n=(o?n:e)[t[o]]);++o);return n},y=function(e){return["__proto__","prototype","constructor"].includes(e)},g=function(e,r,n){if(r=l(r),!e||!r)return p("the parameter is illegal");if(!a(r))return s(e,r,n);for(var t=h({path:r}).keys,i=0,o=t.length;i<o;i++){var u=t[i];y(u)||(null==e[u]&&(e[u]={}),i===o-1?s(e,u,n):e=e[u])}},b=function(e,r){var n;if(r=l(r),e&&r){if(!a(r))return void c(e,r);var t=d(e,r+"/..");if(t){var i=null!==(n=h({path:r}).keys.pop())&&void 0!==n?n:"";c(t,i)}}},k=function(e,r,n){if(r=l(r),n=l(n),!(e&&r&&n&&t(r)&&t(n)))return p("the parameter is illegal");var i=d(e,r),o=d(e,n);g(e,n,i),g(e,r,o)},m=function(e,r,t,i){if(r=l(r),!e)return p("the parameter is illegal");if(!i)throw new Error("direction must be 'before' | 'after' | 'append'");var o=d(e,r+"/..");if(!n(o))throw new Error("insert node must be a Array");var u=+h({path:r}).keys.pop(),a=u;"after"===i?a=u+1:"before"===i&&(a=u),v(o,a,t)},w=Array.prototype,x=function(){for(var e=[],r=0;r<arguments.length;r++)e[r]=arguments[r];var n=w.concat.apply(w,e).join("/").split("/");return h({keys:n}).path},O=function(e,r){var n=r.split("/"),t=e.split("/"),i=n.slice(0,n.length-1),o=t.slice(0,n.length-1);return!(n.length>t.length)&&i.join("/")===o.join("/")},_=function(e,r,i,o){var u,a,s;if(r=l(r),i=l(i),!(e&&r&&i&&t(r)&&t(i)))return p("the parameter is illegal");if(r!==i){var v=d(e,i),y=d(e,r),k=d(e,i+"/.."),w=+(null!==(u=h({path:r}).keys.pop())&&void 0!==u?u:""),_=+(null!==(a=h({path:i}).keys.pop())&&void 0!==a?a:"");if(n(k)){if(!o)throw new Error("direction must be 'before' | 'after' | 'append'");return x()===x()?(m(e,i,y,o),void c(k,w+(_>w?0:1))):O(r,i)&&_<+(null!==(s=r.split("/").slice(0,i.split("/").length).pop())&&void 0!==s?s:"")?(b(e,r),void m(e,i,y,o)):(m(e,i,y,o),void b(e,r))}if(!f(v))throw new Error("'"+i+"': "+v+" is primitive values");g(e,i+"/"+r,y),b(e,r)}},j=function(e,r,t,i){if(void 0===i&&(i=1),r=l(r),!(o(i)&&i>0))return p("the parameter is illegal");if(!e)return p("the parameter is illegal");var u=d(e,r+"/..");if(!n(u))return p("must be a Array");var a=u.length,f=+h({path:r}).keys.pop();if(o(f)&&!(f>a-1)){var s=f+t*i;s<=0&&(s=0),s>a-1&&(s=a-1);var y=u[f];c(u,f),v(u,s,y)}},E=function(e,r,n){j(e,r,-1,n)},A=function(e,r,n){j(e,r,1,n)},P=function(e,r){var n=+h({path:e}).keys.pop();return i(n)?"prev"===r?x():"next"===r?x():null:null},B=function(e,r){if(void 0===r&&(r=[]),!f(e))return!1;r.push(e);for(var n in e)if(e.hasOwnProperty(n)){var t=e[n];if(f(t)&&(~r.indexOf(t)||B(t,r.slice())))return!0}return!1},I=function(e,r){for(var n=!1,t=function(){n=!0},i=0,o=Object.keys(e);i<o.length;i++){var u=o[i];if(n)break;r(e[u],u,e,{_break:t})}},M=function(e,t,i){if(void 0===e&&(e={}),void 0===t&&(t=r),void 0===i&&(i=r),B(e))throw new Error("obj is a circular structure");var o=[],u=function(e){return I(e,function(e,r,a,l){var p=l._break,s=!1,c=function(){p(),s=!0,n(a)&&o.pop()};if(o.push(r),t(e,r,a,{path:x(),_break:c}),o.pop(),f(e)){if(o.push(r),s)return;u(e),o.pop(),i(e,r,a,{path:x(),_break:c})}}),e};return u(e)};e._computePath=P,e.down=A,e.get=d,e.insert=m,e.isCircular=B,e.mv=_,e.normalizePath=x,e.rm=b,e.set=g,e.swap=k,e.up=E,e.walk=M,Object.defineProperty(e,"__esModule",{value:!0})});
